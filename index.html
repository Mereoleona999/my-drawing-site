<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ุฃููุงุฑ ุฑุณู ุนุดูุงุฆูุฉ</title>
  <link rel="icon" href="https://static-00.iconduck.com/assets.00/artist-palette-emoji-2048x1860-ns605395.png" type="image/png" />
  <style>
    html, body { margin: 0; padding: 0; overflow: hidden; height: 100vh; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #41493b; display: flex; align-items: center; justify-content: center; flex-direction: column; }
    #menu, #card { display: none; }
    #menu.active {
      display: grid;
      grid-template-columns: repeat(2, 160px);
      grid-auto-rows: 60px;
      gap: 20px;
      justify-content: center;
    }
    .menu-btn { width: 100%; height: 100%; font-size: 20px; border: none; border-radius: 8px; background: #ff9800; color: #fff; cursor: pointer; }
    .menu-btn:hover { background: #fb8c00; }
    .custom-btn { grid-column: span 2; }
    #card.active { display: flex; flex-direction: column; align-items: center; }
    .card { background: #a5ae9d; width: 400px; height: 320px; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); position: relative; display: flex; flex-direction: column; align-items: center; }
    .back-btn { position: fixed; top: 10px; left: 10px; background: #ff5555; color: #fff; border: none; padding: 10px 15px; font-size: 16px; border-radius: 8px; cursor: pointer; display: none; }
    .back-btn.show { display: block; }
    #score { position: fixed; top: 10px; right: 10px; font-size: 40px; color: #fff; z-index: 100; }
    h1 { margin: 0; font-size: 24px; color: white; }
    button.main { background-color: #00aaff; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-size: 16px; cursor: pointer; margin: 15px 0; } /* ุชูููู ุญุฌู ุงูุฒุฑ */
    button.main:hover { background-color: #008ecc; }
    #idea { font-size: 18px; font-weight: bold; color: white; max-height: 100px; overflow-y: auto; width: 100%; white-space: pre-wrap; text-align: center; }
    #timer { font-size: 20px; color: #ff5555; margin-top: 10px; }
    .time-buttons { display: flex; gap: 10px; margin-top: 15px; }
    .time-buttons button { background-color: #90be6d; border: none; font-size: 16px; cursor: pointer; border-radius: 8px; padding: 6px 12px; transition: background-color 0.2s; }
    .time-buttons button:hover { background-color: #6a9e4d; }
    .point-buttons { display: none; margin-top: 15px; gap: 10px; justify-content: center; }
    .point-buttons button { white-space: nowrap; background-color: #ff9800; color: white; border: none; padding: 8px 16px; border-radius: 8px; font-size: 16px; cursor: pointer; transition: background-color 0.2s; }
    .point-buttons button:hover { background-color: #fb8c00; }
    .add-idea { position: fixed; bottom: 15px; left: 15px; display: flex; gap: 8px; }
    .add-idea input { width: 200px; padding: 8px 12px; border: none; border-radius: 8px; background: rgba(255,255,255,0.5); font-size: 16px; outline: none; }
    .add-idea button { background-color: #90be6d; color: white; border: none; padding: 8px 16px; border-radius: 8px; font-size: 16px; cursor: pointer; }
    footer { position: fixed; bottom: 5px; width: 100%; text-align: center; font-size: 14px; color: #ccc; }
    #startDrawingBtn { margin-top: 10px; width: 75%; max-width: 300px; } /* ุถุจุท ุนุฑุถ ุงูุฒุฑ ููููู ุฃูู ุนุฑุถ */
  </style>
</head>
<body>
  <button class="back-btn" id="backBtn" onclick="showMenu()">โฌ๏ธ ุฑุฌูุน</button>
  <div id="menu" class="active">
    <button class="menu-btn" onclick="init('easy')">ุณูู</button>
    <button class="menu-btn" onclick="init('medium')">ูุชูุณุท</button>
    <button class="menu-btn" onclick="init('hard')">ุตุนุจ</button>
    <button class="menu-btn" onclick="init('random')">ุนุดูุงุฆู</button>
    <button class="menu-btn custom-btn" onclick="init('custom')">ูุฎุตุต</button>
  </div>
  <div id="score">ุงูููุงุท: 0</div>
  <div id="card" class="card">
    <h1>๐จ ููุฑุฉ ุฑุณู ุนุดูุงุฆูุฉ</h1>
    <button class="main" onclick="generateIdea()">ุงุนุทูู ููุฑุฉ</button>
    <div id="idea"></div>
    <div id="timer"></div>
    <div class="time-buttons">
      <button onclick="startTimer()" id="startBtn" style="display:none;">โถ๏ธ ุงุจุฏุฃ ุงููุคูุช</button>
      <button onclick="stopTimer()" id="stopBtn" style="display:none;">โน๏ธ ุฃููู ุงููุคูุช</button>
      <button onclick="resumeTimer()" id="resumeBtn" style="display:none;">โถ๏ธ ุงุณุชุฆูุงู ุงููุคูุช</button>
    </div>
    <div class="point-buttons" id="pointButtons">
      <button id="finishEarlyBtn">ุงูุชููุช +0</button>
      <button id="finishLateBtn">ุงูุชููุช +0</button>
      <button id="failBtn">ูุดูุช +0</button>
    </div>
  </div>
  
  <!-- ุฒุฑ ุงุจุฏุฃ ุงูุฑุณู ููุถูุน ุชุญุช ุงููุฑุจุน ุจุดูู ูุฑูุฒู -->
  <button class="main" id="startDrawingBtn" style="display: none;" onclick="openDrawingPage()">ุงุจุฏุฃ ุงูุฑุณู</button>

  <div class="add-idea">
    <input id="newIdea" placeholder="ุงูุชุจ ููุฑุชู ููุงโฆ" />
    <button onclick="addIdea()">ุฅุถุงูุฉ ููุฑุฉ</button>
    <button onclick="removeIdea()">ุญุฐู ููุฑุฉ</button>
  </div>
  <footer>โจ ุตููุน ุจุญุจ ุจูุงุณุทุฉ <strong>mereoleona โค๏ธ</strong></footer>
  <audio id="alarmSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
  <script>
const builtInIdeas = [
  "ุงุฑุณู ุฑูุจูุช ูุญุงูู ุงูุทุจุฎ ูุฃูู ูุฑุฉ - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ูุชุงุฉ ุชูุฑุฃ ูุชุงุจูุง ูุณุท ุนุงุตูุฉ - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุณููุฉ ุชุทูุฑ ูู ุงูุณูุงุก ูุชูุจุณ ูุธุงุฑุงุช - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุดุฎุตูุฉ ุจุงุณุชุฎุฏุงู ุฃุดูุงู ุฏุงุฆุฑูุฉ ููุท - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุญููุงู ุจุงุณุชุฎุฏุงู ูุซูุซุงุช ููุท - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ูุต ูุฌู ุฅูุณุงู ููุต ูุฌู ูุทุฉ - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุจูุช ุนูู ุดูู ูุทุฑ - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ูุฌู ููููู ูู ูุจุงุชุงุช - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ูุฏููุฉ ููู ุธูุฑ ุชููู - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุฑูุจูุช ูุญุงูู ุงูุฑูุต - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุทุฉ ุชุฑุชุฏู ุฏุฑุน ูุงุฑุณ - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุดุฌุฑุฉ ูููุง ุฃุจูุงุจ ูููุงูุฐ - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ูุฏ ุชูุณู ุงููุฌุฑุฉ - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุดุฎุตูุฉ ุจุฃุณููุจ ุจููุณู - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุดุฎุตูุฉ ุจุฏูู ููุงูุญ - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ููุจ ุนุตูุฑ ูุญุชูู ุนูู ููุงูุจ - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุนุงูู ุฏุงุฎู ูุธุงุฑุฉ ุดูุณูุฉ - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุชุงุฉ ุชุฑุชุฏู ูุณุชุงู ูู ุงูุฒููุฑ - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ูุฏููุฉ ุชุญุช ุงูุจุญุฑ - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุนูู ุชุฑู ุงูููู - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุญููุงู ุฎูุงูู ุจุฏูุฌ ูฃ ุญููุงูุงุช - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ููุณู ููุฑุชูู - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุดุฎุตูุฉ ูู ุงูุฎูู ููุท - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุณุงูุฏููุชุด ููู ูุฏููุฉ - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุทูู ูุทูุฑ ุจูุงุณุทุฉ ุจุงูููุงุช - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุธู ูุฎุงูู ุดูู ุตุงุญุจู - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ูุงูุฐุฉ ุชุทู ุนูู ุนุงูู ุฎูุงูู - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุดุฎุตูุฉ ูุฑุณููุฉ ุจุฎุท ูุงุญุฏ ููุท - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ูุฑุฏุฉ ุชููู ูู ูุชุงุจ - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุนุงูู ุฏุงุฎู ูุทุฑุฉ ูุงุก - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ูุทุฉ ุชุนุฒู ุนูู ุขูุฉ ููุณูููุฉ - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุฑุณู ุนูู ุดูู ูุฎููู - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุทุฑูู ููุชูู ูู ุงููุถุงุก - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุงุฆู ุดูุงู - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุทุงููุฉ ูุทูุฑ ููู ุงูุนูุงุตุฑ ุชุชุญุฑู - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุนุงูู ุฏุงุฎู ูุตุจุงุญ - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุงูุณุงุนุฉ ููู ุชุฐูุจ - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ููุชุงุญ ูุฏูู โ โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ููุงุฏุฉ โ โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุฑูุดุฉ ุทุงุฆุฑ โ โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ูุฑุฏุฉ ุฐุงุจูุฉ โ โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ููุฏูู ุจุญุฑ โ โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ููุญุฉ ุฅุนูุงูุงุช ูู ูุฏููุฉ โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุฎุฑูุทุฉ ููุฒ โ โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ูุชุงุฉ ุชุทูุฑ ููู ูุฏููุฉ โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุจุงูููุงุช ุชุทูุฑ ููู ุจุญุฑ โ โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุนูู ุชูุนูุณ ูููุง ุดุฌุฑุฉ โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุฌู ูุบุทู ุจุฃูุฑุงู ุงูุดุฌุฑ โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุฏุฑุฌ ูุตู ุฅูู ุงูุณุญุงุจ โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุดุงุฑุน ูู ููู ููุทุฑ โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุณูุงุฑุฉ ุชุทูุฑ ูู ุงูุณูุงุก โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุฒุฑุงูุฉ ุชุฑุชุฏู ูุจุนุฉ ููุธุงุฑุงุช โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุฎููุฉ ุนูู ุธูุฑ ุณูุญูุงุฉ โ โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ูุทุงุฑ ูุณูุฑ ุจูู ุงููุฌูู โ โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ูุชุงุฉ ุชุฑูุจ ุนูู ุณููุฉ ุถุฎูุฉ โ โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ููุฑ ูู ุงูุฌุจู โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุฏููุฉ ุฏุงุฎู ุฒุฌุงุฌุฉ โ โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุจูุถุฉ ุชููุณุฑ ู ุฏุงุฎููุง ุญุฏููุฉ โ โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุทูู ูุชุฒูุฌ ุนูู ููุณ ูุฒุญ โ โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุณูููุฉ ุทุงุฆุฑุฉ ุชูุฑ ููู ุฌุจุงู โ โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุฏุฑุงุฌุฉ ุชุทูุฑ ุจุฃุฌูุญุฉ โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูููุจ ูู ูุฌู ุฅูุณุงูู โ โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ูููููุฉ ูููุง ุจุญุฑ โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุจุนุฉ ุชุทูุฑ โ โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุดุฌุฑุฉ ุนูู ุดูู ุฅูุณุงู โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุจูุถุฉ ุฏููุงุตูุฑ ุนูู ูุดู ุงูููุณ โ โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ูุงุฑุจ ูุฑูู ูู ุจุญุฑ โ โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ููุจ ุดุงู ููู ุณูุงุก ูุบููู โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุญุงุณุจุฉ ูููุง ูุทุฉ โ โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ููุจ ููู ูุฏููุฉ โ โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ููุจ ูููุฉ ุนูู ุดูู ุฌุจู โ โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุต ูุฌู ุฅูุณุงู ููุต ูุฌู ุฑูุจูุช - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุฏููุงุตูุฑ ูุฑูุจ ุฏุฑุงุฌุฉ - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุถุงุก ุจุฏูู ุงุณุชุฎุฏุงู ููู ุฃุณูุฏ - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุทูู ูุฑูุจ ุนูู ุณุญุงุจุฉ - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุฏููุฉ ููู ุณูุญูุงุฉ ุนููุงูุฉ - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุณุญููุฉ ุนูู ุดูู ูุงุทุญุฉ ุณุญุงุจ - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุณุงุนุฉ ุจุฏูู ุฃุฑูุงู - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ูุดุงุนุฑู ุงูุญุงููุฉ ููุงุฆู - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุจุงุจ ููุชูุญ ุนูู ุนุงูู ุขุฎุฑ - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุดูุก ุบูุฑ ุญู ูุฃูู ุญู - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุญููุงู ุจุนูู ูุงุญุฏุฉ ูุจูุฑุฉ ุฌุฏูุง - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุจุญุฑ ููููุจ - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุฃุณุฏ ูุงุฆู ูุณุท ุฒููุฑ - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุญููุจุฉ ูููุฆุฉ ุจุงูููุงูุจ - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุบููุฉ ุนูู ููุฆุฉ ูุทุฉ - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุจูุช ูู ุงููุฑู - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุฒูุฑุฉ ุฏุงุฎู ูุตุจุงุญ - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุฅูุณุงู ูุตูู ุดุชุงุก ููุตูู ุตูู - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุฒูุฑุฉ ุบุฑูุจุฉ ุงูุดูู - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุญููุงู ุจุฃุฑุจุน ุฃุนูู - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุณุงุนุฉ ุนูู ุดูู ุฒูุฑุฉ - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ูุทุฉ ุฏุงุฎู ุชููุงุฒ ูุฏูู - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ูุฏููุฉ ุตุบูุฑุฉ ููู ุณุญุงุจุฉ - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุดุฌุฑุฉ ุชุญุชูู ุนูู ูุฌูู - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุฏ ุดูุงูุฉ - โฑ๏ธ 5 ุฏูููุฉ",
  "ุงุฑุณู ูุทุฉ ุชูุงู ููู ูููุจ - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุบููุฉ ุชูุทุฑ ูููุจูุง - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุดูุณ ููุง ูุฌู - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ูููุจ ุนูู ุดูู ูุงููุฉ - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ูุฏููุฉ ูุนููุฉ - โฑ๏ธ 30 ุฏูููุฉ",
  "ุงุฑุณู ุดุฌุฑุฉ ุชูุจุช ูููุง ุงููุตุงุจูุญ - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ูุฌููุง ุจุงุณุชุฎุฏุงู ุงูุฃุฑูุงู ููุท - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุฒุฑุงูุฉ ุชุทู ูู ูุงูุฐุฉ - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุฒูุฑุฉ ุชุชูุชุญ ููู ุฏุงุฎููุง ุนูู - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ุจุทุฉ ููู ููุญ ุชุฒูุฌ - โฑ๏ธ 5 ุฏูุงุฆู",
  "ุงุฑุณู ุจุทุฑูู ูู ุงูุตุญุฑุงุก - โฑ๏ธ 10 ุฏูุงุฆู",
  "ุงุฑุณู ูุทุงุฑ ููุฑ ูู ุจุญุฑ - โฑ๏ธ 15 ุฏูููุฉ",
  "ุงุฑุณู ุฎุฑูุทุฉ ูุนุงูู ุฎูุงูู - โฑ๏ธ 30 ุฏูููุฉ",
];

const savedIdeas = JSON.parse(localStorage.getItem('customIdeas') || '[]');
const customSet = new Set(savedIdeas);
let allIdeas = [...builtInIdeas, ...savedIdeas];
const groups = { easy: [], medium: [], hard: [], custom: savedIdeas };
allIdeas.forEach(txt => {
  const m = txt.match(/โฑ๏ธ\s*(\d+)/);
  const minutes = m ? parseInt(m[1], 10) : 10;
  if (minutes <= 10) groups.easy.push(txt);
  else if (minutes <= 20) groups.medium.push(txt);
  else groups.hard.push(txt);
});
const usedByLevel = { easy: new Set(), medium: new Set(), hard: new Set(), random: new Set(), custom: new Set() };
let prevLevel = null, currentLevel = null;
let currentSet = [], used, timerInterval, initialDuration, remainingTime, points = 0, currentIdea = '';
const scoreEl = document.getElementById('score');
const backBtn = document.getElementById('backBtn');
const menuEl = document.getElementById('menu');
const cardEl = document.getElementById('card');
const startBtn = document.getElementById('startBtn');
const stopBtn = document.getElementById('stopBtn');
const resumeBtn = document.getElementById('resumeBtn');
const pointButtons = document.getElementById('pointButtons');
const finishEarlyBtn = document.getElementById('finishEarlyBtn');
const finishLateBtn = document.getElementById('finishLateBtn');
const failBtn = document.getElementById('failBtn');
const ideaEl = document.getElementById('idea');
const timerEl = document.getElementById('timer');

// ุฏุงูุฉ ูุชุญ ุตูุญุฉ ุงูุฑุณู
function openDrawingPage() {
    window.open('drawing.html', '_blank'); // ููุชุญ ุตูุญุฉ ุฌุฏูุฏุฉ ููููุฏ ุงูุซุงูู
}

function showMenu() {
  clearInterval(timerInterval);
  timerEl.innerText = '';
  startBtn.style.display = stopBtn.style.display = resumeBtn.style.display = 'none';
  pointButtons.style.display = 'none';
  menuEl.classList.add('active'); cardEl.classList.remove('active'); backBtn.classList.remove('show');
}

function init(level) {
  if (prevLevel !== level) usedByLevel[level].clear(); prevLevel = level;
  clearInterval(timerInterval); timerEl.innerText = '';
  startBtn.style.display = stopBtn.style.display = resumeBtn.style.display = 'none'; pointButtons.style.display = 'none'; ideaEl.innerText = '';
  currentLevel = level;
  currentSet = level === 'random' ? allIdeas : level === 'custom' ? savedIdeas : groups[level];
  used = usedByLevel[level];
  if (level === 'custom' && savedIdeas.length === 0) {
    ideaEl.innerText = 'ูุง ุชูุฌุฏ ุฃููุงุฑ ูุถุงูุฉ.\nููููู ุฅุถุงูุฉ ุฃููุงุฑ ุฌุฏูุฏุฉ ูู ุงูุฎุงูุฉ ุจุงููุณุงุฑ.';
    document.querySelector('button.main').style.display = 'none';
  } else {
    ideaEl.style.textAlign = 'center';
    document.querySelector('button.main').style.display = 'inline-block';
  }
  menuEl.classList.remove('active'); cardEl.classList.add('active'); backBtn.classList.add('show');
}

function generateIdea() {
  clearInterval(timerInterval); timerEl.innerText = '';
  startBtn.style.display = stopBtn.style.display = resumeBtn.style.display = 'none'; pointButtons.style.display = 'none'; ideaEl.style.textAlign = 'center';
  if (used.size === currentSet.length) { ideaEl.innerText = 'ุชู ุนุฑุถ ูู ุงูุฃููุงุฑ!'; return; }
  let txt; do { txt = currentSet[Math.floor(Math.random()*currentSet.length)]; } while (used.has(txt)); used.add(txt);
  ideaEl.innerText = txt; currentIdea = txt;
  const m = txt.match(/โฑ๏ธ\s*(\d+)/);
  if (m) { initialDuration = parseInt(m[1],10)*60; remainingTime = initialDuration; startBtn.style.display = 'inline-block'; }
}

function calculatePrimary() { return customSet.has(currentIdea)?10: initialDuration===300?10: initialDuration===600?20: initialDuration===900?30: initialDuration===1800?50:0; }
function calculateLate() { return calculatePrimary()/2; }

function updateTimer() { const m=Math.floor(remainingTime/60), s=remainingTime%60; timerEl.innerText = `โฑ๏ธ ุงูููุช ุงููุชุจูู: ${m}:${s<10?'0':''}${s}`; }
function startTimer() {
  startBtn.style.display='none'; stopBtn.style.display='inline-block'; resumeBtn.style.display='none'; pointButtons.style.display='flex';
  document.getElementById('startDrawingBtn').style.display = 'inline-block'; // ุงุธูุงุฑ ุงูุฒุฑ ููุง
  finishEarlyBtn.style.display='inline-block'; finishLateBtn.style.display=failBtn.style.display='none';
  finishEarlyBtn.textContent = `ุงูุชููุช +${calculatePrimary()}`; updateTimer();
  timerInterval = setInterval(() => {
    remainingTime--;
    if (remainingTime<=0) { clearInterval(timerInterval); timerEl.innerText='โฑ๏ธ ุงูุชูู ุงูููุช!'; stopBtn.style.display=resumeBtn.style.display='none'; finishEarlyBtn.style.display='none'; finishLateBtn.style.display=failBtn.style.display='inline-block'; finishLateBtn.textContent=`ุงูุชููุช +${calculateLate()}`; playAlarmRepeatedly(4); } else updateTimer();
  },1000);
}
function stopTimer() { clearInterval(timerInterval); timerEl.innerText='โฑ๏ธ ุชู ุฅููุงู ุงููุคูุช.'; stopBtn.style.display='none'; resumeBtn.style.display='inline-block'; }
function resumeTimer() { resumeBtn.style.display='none'; startTimer(); }

finishEarlyBtn.onclick = () => { 
  clearInterval(timerInterval); 
  points += calculatePrimary(); 
  scoreEl.textContent = `ุงูููุงุท: ${points}`; 
  generateIdea(); 
  document.getElementById('startDrawingBtn').style.display = 'none'; // ุฅุฎูุงุก ุฒุฑ "ุงุจุฏุฃ ุงูุฑุณู"
};
finishLateBtn.onclick = () => { 
  clearInterval(timerInterval); 
  points += calculateLate(); 
  scoreEl.textContent = `ุงูููุงุท: ${points}`; 
  generateIdea(); 
  document.getElementById('startDrawingBtn').style.display = 'none'; // ุฅุฎูุงุก ุฒุฑ "ุงุจุฏุฃ ุงูุฑุณู"
};
failBtn.onclick = () => { 
  clearInterval(timerInterval); 
  scoreEl.textContent = `ุงูููุงุท: ${points}`; 
  generateIdea(); 
  document.getElementById('startDrawingBtn').style.display = 'none'; // ุฅุฎูุงุก ุฒุฑ "ุงุจุฏุฃ ุงูุฑุณู"
};

function addIdea() {
  const txt = document.getElementById('newIdea').value.trim(); if (!txt) return;
  const formatted = `${txt} - โฑ๏ธ 10 ุฏูุงุฆู`;
  allIdeas.push(formatted); savedIdeas.push(formatted); customSet.add(formatted);
  localStorage.setItem('customIdeas', JSON.stringify(savedIdeas)); groups.custom = savedIdeas;
  document.getElementById('newIdea').value = '';
  alert('ุชูุช ุฅุถุงูุฉ ููุฑุชู!');
}

function removeIdea() {
  const txt = document.getElementById('newIdea').value.trim(); if (!txt) return alert('ุงูุชุจ ุงูููุฑุฉ ูุญุฐููุง.');
  const formatted = `${txt} - โฑ๏ธ 10 ุฏูุงุฆู`;
  const idx = savedIdeas.indexOf(formatted); if (idx === -1) return alert('ูุฐู ุงูููุฑุฉ ุบูุฑ ููุฌูุฏุฉ.');
  savedIdeas.splice(idx, 1); allIdeas = allIdeas.filter(i=>i!==formatted); customSet.delete(formatted);
  localStorage.setItem('customIdeas', JSON.stringify(savedIdeas)); groups.custom = savedIdeas;
  document.getElementById('newIdea').value = '';
  alert('ุชู ุญุฐู ุงูููุฑุฉ!');
}

function playAlarmRepeatedly(times) {
  const alarm = document.getElementById('alarmSound'); let count = 0;
  const play = () => { if (count < times) { alarm.currentTime = 0; alarm.play(); count++; setTimeout(play, 1000); }};
  play();
}
  </script>
</body>
</html>